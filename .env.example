# VAR熔池视频分析系统 - 环境变量配置模板
# 复制此文件为 .env 并修改相应的配置值

# ==================== 数据库配置 ====================
DB_HOST=localhost
DB_PORT=5432
DB_NAME=var_analysis
DB_USER=var_user
DB_PASSWORD=your_secure_password_here

# ==================== Redis配置 ====================
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=your_redis_password_here
REDIS_DB=0

# ==================== RabbitMQ配置 ====================
RABBITMQ_HOST=localhost
RABBITMQ_PORT=5672
RABBITMQ_USER=var_user
RABBITMQ_PASSWORD=your_rabbitmq_password_here
RABBITMQ_VHOST=/

# 视频分析任务队列（Backend → AI模块）
RABBITMQ_VIDEO_ANALYSIS_QUEUE=video_analysis_queue

# ==================== 端口配置 ====================
# 前端开发服务器端口
FRONTEND_PORT=3000
# 后端服务器端口
SERVER_PORT=8080
# AI处理模块端口
AI_PROCESSOR_PORT=5000

# ==================== 文件存储配置 ====================
# 存储基础路径（相对于 codes/ 目录）
# 开发环境: ./storage 或 storage
# 生产环境: /var/var-analysis/storage（Docker卷挂载）
STORAGE_BASE_PATH=storage

# 存储子目录（相对于 STORAGE_BASE_PATH）
# 这些路径会被自动拼接到 STORAGE_BASE_PATH 后面
STORAGE_VIDEOS_SUBDIR=videos
STORAGE_RESULT_VIDEOS_SUBDIR=result_videos
STORAGE_PREPROCESSED_VIDEOS_SUBDIR=preprocessed_videos
STORAGE_TEMP_SUBDIR=temp

# ==================== 服务URL配置 ====================
# 后端服务基础URL（不包含 /api 路径）
BACKEND_BASE_URL=http://localhost:8080

# 前端应用URL
FRONTEND_BASE_URL=http://localhost:3000

# AI处理模块服务URL
AI_PROCESSOR_URL=http://localhost:5000

# 内部服务认证Token（后端和AI模块通信使用）
INTERNAL_TOKEN=your_internal_token_12345_change_in_production

# ==================== AI模型配置 ====================
# YOLO模型路径（相对于 ai-processor 目录）
YOLO_MODEL_PATH=weights/best.pt
# YOLO_MODEL_VERSION 已弃用，现在从模型检查点文件动态读取
# 计算设备（空字符串=自动选择，可选: cpu, cuda, mps, 0, 1等）
YOLO_DEVICE=
# 是否显示详细输出（调试时启用）
YOLO_VERBOSE=False

# ==================== 追踪器配置 ====================
# 追踪器配置文件（相对于 ai-processor 目录）
# 可选: botsort.yaml 或 bytetrack.yaml
TRACKER_CONFIG=botsort.yaml

# 以下参数仅在通过代码动态配置tracker时生效（不使用YAML文件）
# 高置信度阈值（第一次关联）
TRACK_HIGH_THRESH=0.5
# 低置信度阈值（第二次关联）
TRACK_LOW_THRESH=0.1
# 新轨迹初始化阈值
NEW_TRACK_THRESH=0.6
# 轨迹缓冲帧数（目标丢失后保留的帧数）
TRACK_BUFFER=30
# 轨迹匹配阈值（IoU）
MATCH_THRESH=0.8
# 融合检测置信度分数
FUSE_SCORE=False
# 全局运动补偿方法（None/sparseOptFlow/orb/sift/ecc）
GMC_METHOD=None

# BotSort特有参数
WITH_REID=False
PROXIMITY_THRESH=0.5
APPEARANCE_THRESH=0.25

# ==================== 任务配置 ====================
# 默认超时比例（格式：分子:分母）
# 示例：1:4 表示30分钟视频最多处理120分钟
DEFAULT_TIMEOUT_RATIO=1:4
# 默认置信度阈值（0.1-0.9）
DEFAULT_CONFIDENCE_THRESHOLD=0.5
# 默认IoU阈值（0.3-0.7）
DEFAULT_IOU_THRESHOLD=0.45
# 进度更新频率（每处理多少帧更新一次）
PROGRESS_UPDATE_INTERVAL=30

# ==================== CORS配置 ====================
CORS_ORIGINS=http://localhost:3000

# ==================== 雪花算法配置 ====================
# 数据中心ID（0-31，多数据中心部署时需要不同）
SNOWFLAKE_DATACENTER_ID=0
# 工作机器ID（0-31，同一数据中心多实例部署时需要不同）
SNOWFLAKE_WORKER_ID=0

# ==================== 日志配置 ====================
# 后端日志级别
LOG_LEVEL=DEBUG
WEB_LOG_LEVEL=INFO
SQL_LOG_LEVEL=DEBUG
SQL_PARAM_LOG_LEVEL=TRACE
SHOW_SQL=false

# AI处理模块日志级别（INFO, DEBUG, WARNING, ERROR）
AI_LOG_LEVEL=INFO
